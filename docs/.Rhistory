y = matrix(d$kid_score, ncol = 1)
load("datos/kidiq.Rdata")
str(d)
y = matrix(d$kid_score, ncol = 1)
head(y)
n = nrow(d)
X = cbind(rep(1,n), d$mom_iq, d$mom_age)
head(X)
Xt_X = t(X) %*% X
Xt_y = t(X) %*% y
( B = solve(Xt_X) %*% Xt_y )
y_e = X %*% B
View(d)
# en primer lugar vamos a calcular las matrices de covarianzas con la función de R cov()
(Sxx = cov(d[c(3,5),c(3,5)]) )
(Sxy = S(d[c(3,5),1]) )
# en primer lugar vamos a calcular las matrices de covarianzas con la función de R cov()
(Sxx = cov(d[c(3,5),c(3,5)]) )
(Sxy = cov(d[c(3,5),1]) )
# en primer lugar vamos a calcular las matrices de covarianzas con la función de R cov()
(Sxx = cov(d[,c(1,3,5)]) )
(Sxy = cov(d[,c(1,3,5)]) )
(Ba = solve(Sxx) %*% Sxy)
# en primer lugar vamos a calcular las matrices de covarianzas con la función de R cov()
(S = cov(d[,c(1,3,5)]) )
(Sxx = S[2:3,2:3])
(Sxy = S[2:3,1] )
(Ba = solve(Sxx) %*% Sxy)
ya = matrix(d$kid_score - mean(d$kid_score), ncol = 1)
Xa = cbind(d$mom_iq - mean(d$mom_iq), d$mom_age - mean(d$mom_age)) # sin columna de unos!!!!
ya = matrix(d$kid_score - mean(d$kid_score), ncol = 1)
Xa = cbind(d$mom_iq - mean(d$mom_iq), d$mom_age - mean(d$mom_age)) # sin columna de unos!!!!
n = nrow(d)
1/(n-1) * t(Xa) %*% Xa
1/(n-1) * t(Xa) %*% ya
( b0 = mean(d$kid_score) - colMeans(d[,c(3,5)]) %*% Ba )
(SRC = sum(e^2))
load("datos/kidiq.Rdata")
str(d)
plot(d$mom_iq, d$kid_score)
y = matrix(d$kid_score, ncol = 1)
head(y)
n = nrow(d)
X = cbind(rep(1,n), d$mom_iq, d$mom_age)
head(X)
Xt_X = t(X) %*% X
Xt_y = t(X) %*% y
( B = solve(Xt_X) %*% Xt_y )
y_e = X %*% B
e = y - y_e
(SRC = sum(e^2))
sum(d$kid_score^2) - t(B) %*% (Xt_y
sum(d$kid_score^2) - t(B) %*% Xt_y
# varianza de y
(sy2 = S[1,1] )
(SRC = (n-1)*sy2 - (n-1)*t(Ba) %*% Sxy)
load("datos/kidiq.Rdata")
str(d)
plot(d$mom_iq, d$kid_score)
y = matrix(d$kid_score, ncol = 1)
head(y)
n = nrow(d)
X = cbind(rep(1,n), d$mom_iq, d$mom_age)
head(X)
Xt_X = t(X) %*% X
Xt_y = t(X) %*% y
( B = solve(Xt_X) %*% Xt_y )
y_e = X %*% B
e = y - y_e
(SRC = sum(e^2))
sum(d$kid_score^2) - t(B) %*% Xt_y
(STC = sum((y-mean(y))^2))
(R2 = 1 - SRC/STC)
(n-1)*var(y)
# en primer lugar vamos a calcular las matrices de covarianzas con la función de R cov()
(S = cov(d[,c(1,3,5)]) )
(Sxx = S[2:3,2:3])
(Sxy = S[2:3,1] )
(Ba = solve(Sxx) %*% Sxy)
ya = matrix(d$kid_score - mean(d$kid_score), ncol = 1)
Xa = cbind(d$mom_iq - mean(d$mom_iq), d$mom_age - mean(d$mom_age)) # sin columna de unos!!!!
n = nrow(d)
1/(n-1) * t(Xa) %*% Xa
1/(n-1) * t(Xa) %*% ya
( b0 = mean(d$kid_score) - colMeans(d[,c(3,5)]) %*% Ba )
# varianza de y
(sy2 = S[1,1] )
(SRC = (n-1)*sy2 - (n-1)*t(Ba) %*% Sxy)
Por último, para la suma de los residuos al cuadrado se tiene que cumplir que:
